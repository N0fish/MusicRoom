### User-service :
–°–µ—Ä–≤–∏—Å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤–∏–∑–∏—Ç–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –ø—É–±–ª–∏—á–Ω–æ—Å—Ç—å –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–≤—è–∑–∏.

–≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å –ø–æ–ª—É—á–∞–µ—Ç X-User-Id –æ—Ç API Gateway (–∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç JWT).
–í—Å–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ API Gateway.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
üîπ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- displayName
- username (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π —á–∏—Ç–∞–µ–º—ã–π –Ω–∏–∫, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: sleepy-strawberry, angry-coffee‚Ä¶)
- avatarUrl (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π SVG –∏–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º)
- –ø—É–±–ª–∏—á–Ω–æ–µ/–¥—Ä—É–∑—å—è–º/–ø—Ä–∏–≤–∞—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- bio
- –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è: –∂–∞–Ω—Ä—ã, –∞—Ä—Ç–∏—Å—Ç—ã, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (–º–∞—Å—Å–∏–≤—ã —Å—Ç—Ä–æ–∫)

üîπ –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å
- public ‚Äî –≤–∏–¥–Ω–æ –≤—Å–µ–º
- friends ‚Äî –≤–∏–¥–Ω–æ —Ç–æ–ª—å–∫–æ –¥—Ä—É–∑—å—è–º
- private ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–∞–≤–∞—Ç–∞—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

üîπ –°–∏—Å—Ç–µ–º–∞ –¥—Ä—É–∑–µ–π:
- –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏
- –ø—Ä–∏–Ω—è—Ç–∏–µ –∑–∞—è–≤–∫–∏
- –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
- —É–¥–∞–ª–µ–Ω–∏–µ –¥—Ä—É–≥–∞
- –∞–≤—Ç–æ-–ø—Ä–∏–Ω—è—Ç–∏–µ –≤—Å—Ç—Ä–µ—á–Ω–æ–π –∑–∞—è–≤–∫–∏

üîπ –ê–≤–∞—Ç–∞—Ä:
- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π
- –≥–µ–Ω–µ—Ä–∞—Ü–∏—è SVG (–∏–¥–µ–Ω—Ç–∏–∫–æ–Ω) —á–µ—Ä–µ–∑ /users/me/avatar/random

üîπ –ü–æ–∏—Å–∫ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- –ø–æ–∏—Å–∫ –ø–æ username
- –ø–æ–∏—Å–∫ –ø–æ displayName

## –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ API Gateway)

`GET /user/me`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å, –≤–∫–ª—é—á–∞—è –≤—Å–µ –ø–æ–ª—è, –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è.
Ex :
```json
{
  "id": "profile-uuid",
  "userId": "auth-user-id",
  "username": "sleepy-strawberry",
  "displayName": "Alla",
  "avatarUrl": "data:image/svg+xml;utf8,...",
  "hasCustomAvatar": true,
  "bio": "Hi!",
  "visibility": "friends",
  "preferences": {
    "genres": ["rock", "pop"],
    "artists": ["Muse"],
    "moods": ["energetic"]
  },
  "createdAt": "...",
  "updatedAt": "..."
}
```
–û—à–∏–±–∫–∏:
- 401 ‚Äî –Ω–µ—Ç X-User-Id ‚Üí API Gateway –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏–ª —Ç–æ–∫–µ–Ω.


`PATCH /users/me`
–∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:
- displayName
- bio
- visibility (public | friends | private)
- preferences (–∂–∞–Ω—Ä—ã, –∞—Ä—Ç–∏—Å—Ç—ã, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ)

–ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω—è—Ç—å –Ω–∞–ø—Ä—è–º—É—é:
- avatarUrl ‚Üí —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ /users/me/avatar/random
- username ‚Üí –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

ex :
```json
{
	"displayName": "lofafa",
	"bio": "DJ from Russia",
	"visibility": "friends",
	"preferences": {
    "genres": ["techno", "house"],
    "artists": ["Syuzi Dogs"],
    "moods": ["party"]
  }
}
```
–û—à–∏–±–∫–∏:
- 400 ‚Äî –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –ø–æ–ª—è
- 401 ‚Äî –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- 500 ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞


`GET /users/{id}`
–ø—É–±–ª–∏—á–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ –∏ –¥—Ä—É–∂–±—ã.
ex responce :
```json
{
	"userId": "target-user-id",
	"username": "wild-lemur",
	"displayName": "",
	"avatarUrl": "/static/avatars/default.png",
	"visibility": "friends",
	"preferences": {}
}
```
–û—à–∏–±–∫–∏:
- 400 ‚Äî –Ω–µ–≤–µ—Ä–Ω—ã–π ID
- 404 ‚Äî –ø—Ä–æ—Ñ–∏–ª—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç


`GET /users/search?query=lo`
–ò—â–µ—Ç –ø–æ:
- username (—Ç–æ—á–Ω–æ–µ/—á–∞—Å—Ç–∏—á–Ω–æ–µ)
- displayName
```json
{
	"items": [
		{
			"userId": "32dee96c-6da1-4671-b4a3-1a126169eb0f",
			"username": "noisy-comet",
			"displayName": "lofafa",
			"avatarUrl": "/static/avatars/default.png"
		},
		{
			"userId": "5234712b-3db3-4778-987a-e66ca5c628f1",
			"username": "shiny-dragon",
			"displayName": "lolo",
			"avatarUrl": "/static/avatars/default.png"
		}
	]
}
```
–û—à–∏–±–∫–∏:
- 400 ‚Äî –Ω–µ—Ç query / —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π
- 401 ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç


## –î—Ä—É–∑—å—è
`GET /users/me/friends`
–°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
ex :
```json
{
	"items": null
}
```
```json
{
  {
    "userId": "5234712b-3db3-4778-987a-e66ca5c628f1",
    "username": "shiny-dragon",
    "displayName": "lolo",
    "avatarUrl": "/static/avatars/default.png"
  }
}
```

`POST /users/me/friends/{id}/request`
–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –≤ –¥—Ä—É–∑—å—è
–û—à–∏–±–∫–∏:
- 400 ‚Äî id –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π / —Å–∞–º —Å–µ–±–µ / —É–∂–µ –¥—Ä—É–∑—å—è
- 404 ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω
- 500 ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–±–æ–π

`POST /users/me/friends/{id}/accept`
–ø—Ä–∏–Ω—è—Ç—å –∑–∞—è–≤–∫—É
–û—à–∏–±–∫–∏:
- 404 ‚Äî –Ω–µ—Ç –≤—Ö–æ–¥—è—â–µ–π –∑–∞—è–≤–∫–∏
- 400 ‚Äî –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π ID

`POST /users/me/friends/{id}/reject`
–æ—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞—è–≤–∫—É
–û—à–∏–±–∫–∏:
- 404 ‚Äî –Ω–µ—Ç –≤—Ö–æ–¥—è—â–µ–π –∑–∞—è–≤–∫–∏
- 400 ‚Äî –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ID

`DELETE /users/me/friends/{id}`
—É–¥–∞–ª–∏—Ç—å –∏–∑ –¥—Ä—É–∑–µ–π
–û—à–∏–±–∫–∏:
- 400 ‚Äî –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ID
- 500 ‚Äî –æ—à–∏–±–∫–∞ –±–∞–∑—ã


## –ê–≤–∞—Ç–∞—Ä
`POST /users/me/avatar/random`
—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π SVG-–∞–≤–∞—Ç–∞—Ä
–°–æ–∑–¥–∞—ë—Ç SVG identicon
ex :
```json
{
  "id": "...",
  "userId": "...",
  "avatarUrl": "data:image/svg+xml;utf8,...",
  "hasCustomAvatar": true
}
```

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç username
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ—Ñ–∏–ª—è:
```bash
"adjective-noun"
sleepy-strawberry
angry-coffee
giant-goose
```

–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä:
- –≤—ã–±–∏—Ä–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—É—é –ø–∞—Ä—É
- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –≤ –ë–î
- –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –¥–æ 20 —Ä–∞–∑
- –ï—Å–ª–∏ –≤—Å–µ –∑–∞–Ω—è—Ç–æ ‚Üí –æ—à–∏–±–∫–∞ –≤ –ª–æ–≥–∞—Ö (–º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ).

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
user_profiles
- id
- user_id (UUID –∏–∑ auth-service)
- display_name
- username
- avatar_url
- visibility
- bio
- preferences (JSONB)
friend_requests
- from_user_id
- to_user_id
- status: pending / accepted / rejected
user_friends
- user1_id
- user2_id

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- User-service –Ω–µ –∑–Ω–∞–µ—Ç –Ω–∏—á–µ–≥–æ –æ JWT.  
  –≠—Ç–æ –¥–µ–ª–∞–µ—Ç API Gateway.
- User-service –Ω–µ —Ö—Ä–∞–Ω–∏—Ç email, –ø–∞—Ä–æ–ª—å –∏–ª–∏ emailVerified.
- User-service –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –∫–∞—á–∞—Ç—å –∏ –æ—Ç–¥–∞–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω–æ, —Ç–∞–∫ –∫–∞–∫:
- - –±–µ–∑ X-User-Id –Ω–∏–∫—Ç–æ –Ω–µ —É–≤–∏–¥–∏—Ç /users/me
- - –≤–∏–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ—Ñ–∏–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º
- - –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –ø–æ–ª—è –∑–∞—â–∏—â–µ–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é
